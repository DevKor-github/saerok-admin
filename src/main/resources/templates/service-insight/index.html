<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(${pageTitle}, ${activeMenu}, ${breadcrumbs}, ~{::content})}">
<th:block th:fragment="content">

    <!-- ÌéòÏù¥ÏßÄ Ï†ÑÏö© CSS -->
    <link th:href="@{/css/service-insight.css(v=${#dates.createNow().getTime()})}" rel="stylesheet">
    <!-- Í≥µÌÜµ ÌÉÄÍπÉ/ÌÉÄÏù¥ÌãÄ Ïä§ÌÉÄÏùº -->
    <link th:href="@{/css/service-insight.target.css(v=${#dates.createNow().getTime()})}" rel="stylesheet">
    <!-- Î™®Î∞îÏùº Ïò§Î≤ÑÎùºÏù¥Îìú -->
    <link th:href="@{/css/service-insight.mobile.css(v=${#dates.createNow().getTime()})}" rel="stylesheet" media="(max-width: 991.98px)">

    <section class="service-insight">
        <div class="service-insight__container">
            <!-- Ï¢åÏ∏°: Îç∞Ïù¥ÌÑ∞/Í∑∏Î£π Ìå®ÎÑê (Î™®Î∞îÏùºÏóêÏÑúÎäî Ïà®ÍπÄ) -->
            <aside class="service-insight__metrics" aria-label="Îç∞Ïù¥ÌÑ∞ ÏÑ†ÌÉù">
                <div class="si-sidebar" id="si-sidebar">
                    <div class="si-sidebar__header">
                        <!-- Îã®Ïùº ÌëúÏãú ÏßÄÏ†ê(PCÏö© ÏïµÏª§) -->
                        <div id="si-target-title-desktop-anchor">
                            <div id="si-target-title" class="si-targettitle" role="heading" aria-level="2">
                                <span class="si-targettitle__prefix">ÌîåÎ°Ø</span>
                                <select id="si-target-select" class="form-select form-select-sm si-targettitle__select" aria-label="Ï†ÅÏö© ÎåÄÏÉÅ ÌîåÎ°Ø(Ïà´Ïûê ÏÑ†ÌÉù)">
                                    <!-- ÏòµÏÖòÏùÄ JSÏóêÏÑú ÎèôÍ∏∞Ìôî -->
                                </select>
                                <span class="si-targettitle__suffix">Îç∞Ïù¥ÌÑ∞ ÏÑ†ÌÉù</span>
                            </div>
                        </div>
                    </div>

                    <!-- Îç∞Ïä§ÌÅ¨ÌÜ± ÏïµÏª§: Î™®Î∞îÏùºÏóêÏÑ† #si-data-panel Ï†ÑÏ≤¥Í∞Ä ÏãúÌä∏Î°ú Ïù¥Îèô -->
                    <div id="si-groups-desktop-anchor">
                        <div id="si-data-panel" class="si-data-panel">
                            <!-- Í∑∏Î£π Î™©Î°ù -->
                            <div class="si-groups" id="si-groups"></div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Ïö∞Ï∏°: ÌîåÎ°Ø ÏòÅÏó≠ -->
            <div class="service-insight__chart">
                <div class="si-plots" id="si-plots" data-size="roomy">
                    <div class="si-plots__toolbar">
                        <div class="si-range" role="region" aria-label="Îç∞Ïù¥ÌÑ∞ Ï°∞Ìöå Í∏∞Í∞Ñ">
                            <div class="si-range__bar">
                                <span class="si-range__label">Í∏∞Í∞Ñ</span>
                                <div class="si-range__quick" role="group" aria-label="Îπ†Î•∏ Ï°∞Ìöå Í∏∞Í∞Ñ">
                                    <a th:each="option : ${rangeQuickOptions}"
                                       th:href="@{/service-insight(range=${option.paramValue()})}"
                                       th:text="${option.displayLabel()}"
                                       th:class="'btn btn-sm si-range__btn ' + (${option.paramValue()} == ${selectedRange} ? 'btn-primary' : 'btn-outline-primary')"
                                       th:data-range="${option.paramValue()}"
                                       th:attr="aria-pressed=${option.paramValue()} == ${selectedRange}"
                                       class="btn btn-sm si-range__btn btn-outline-primary"
                                       aria-pressed="false">ÏµúÍ∑º 1Ï£º</a>
                                </div>
                                <button type="button"
                                        id="si-range-custom-toggle"
                                        th:class="'btn btn-sm si-range__custom-toggle ' + (${customRangeActive} ? 'btn-primary' : 'btn-outline-secondary')"
                                        th:attr="aria-expanded=${customRangeActive}"
                                        class="btn btn-sm btn-outline-secondary si-range__custom-toggle"
                                        aria-expanded="false"
                                        aria-controls="si-range-custom">
                                    <i class="bi bi-calendar-range me-1" aria-hidden="true"></i>ÏßÅÏ†ë ÏÑ§Ï†ï
                                </button>
                            </div>
                            <form id="si-range-custom"
                                  class="si-range__form"
                                  th:class="'si-range__form' + (${customRangeActive} ? ' is-open' : '')"
                                  method="get"
                                  role="form"
                                  aria-label="Í∏∞Í∞Ñ ÏßÅÏ†ë ÏÑ§Ï†ï">
                                <input type="hidden" name="range" value="custom">
                                <div class="si-range__fields">
                                    <label for="si-range-start" class="visually-hidden">ÏãúÏûë ÎÇ†Ïßú</label>
                                    <input id="si-range-start"
                                           type="date"
                                           class="form-control form-control-sm"
                                           name="startDate"
                                           placeholder="ÏãúÏûëÏùº"
                                           th:value="${selectedStartDate}"
                                           autocomplete="off">
                                    <span class="si-range__dash" aria-hidden="true">~</span>
                                    <label for="si-range-end" class="visually-hidden">Ï¢ÖÎ£å ÎÇ†Ïßú</label>
                                    <input id="si-range-end"
                                           type="date"
                                           class="form-control form-control-sm"
                                           name="endDate"
                                           placeholder="Ï¢ÖÎ£åÏùº"
                                           th:value="${selectedEndDate}"
                                           autocomplete="off">
                                </div>
                                <div class="si-range__actions">
                                    <button type="submit"
                                            th:class="'btn btn-sm si-range__apply ' + (${customRangeActive} ? 'btn-primary' : 'btn-outline-secondary')"
                                            class="btn btn-sm btn-outline-secondary si-range__apply">
                                        Ï†ÅÏö©
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div class="si-actions">
                            <button type="button" class="btn btn-ghost" id="si-add-plot">
                                <i class="bi bi-layout-text-window-reverse me-1"></i>ÌîåÎ°Ø Ï∂îÍ∞Ä
                            </button>
                            <button type="button" class="btn btn-ghost" id="si-clear-all">
                                <i class="bi bi-x-circle me-1"></i>Î™®Îëê ÏßÄÏö∞Í∏∞
                            </button>
                        </div>
                    </div>

                    <!-- ÎìúÎ°≠ Í∞ÄÎä•Ìïú ÌîåÎ°Ø Ïπ¥Îìú Í∑∏Î¶¨Îìú -->
                    <div class="si-plot-grid" id="si-plot-grid"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- üì± FAB: Î™®Î∞îÏùº Ï†ÑÏö©(PCÏóêÏÑúÎäî Ï†ÑÏó≠ CSSÎ°ú Í∏∞Î≥∏ Ïà®ÍπÄ) -->
    <button id="si-fab"
            class="btn btn-primary rounded-circle shadow-soft"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#siDataPicker"
            aria-controls="siDataPicker"
            aria-label="Îç∞Ïù¥ÌÑ∞ ÏÑ†ÌÉù Ïó¥Í∏∞">
        <i class="bi bi-sliders2"></i>
    </button>

    <!-- üì± Îç∞Ïù¥ÌÑ∞ ÏÑ†ÌÉù Î∞îÌÖÄ ÏãúÌä∏(Offcanvas) -->
    <div class="offcanvas offcanvas-bottom" tabindex="-1" id="siDataPicker" aria-labelledby="siDataPickerLabel">
        <div class="offcanvas-header">
            <!-- Îã®Ïùº ÌëúÏãú ÏßÄÏ†ê(Î™®Î∞îÏùºÏö© ÏïµÏª§) -->
            <div id="si-target-title-mobile-host"></div>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Îã´Í∏∞"></button>
        </div>
        <div class="offcanvas-body">
            <!-- Î™®Î∞îÏùº Ïãú #si-data-panel Ï†ÑÏ≤¥Í∞Ä Ïó¨Í∏∞Î°ú Ïù¥Îèô -->
            <div id="si-data-panel-mobile-host"></div>
        </div>
    </div>

    <!-- ÏÑúÎ≤ÑÏóêÏÑú ÎÇ¥Î†§Ï£ºÎäî Ï†ÑÏ≤¥ ÌéòÏù¥Î°úÎìú -->
    <script type="application/json" id="serviceInsightData"
            th:data-endpoint="@{/service-insight}"
            th:utext="${chartDataJson}">{"metricOptions":[],"series":[],"componentLabels":{}}</script>

    <!-- Chart.js & Adapter -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.5.0/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1/dist/chartjs-adapter-luxon.umd.min.js"></script>

    <!-- Î≥∏ Ïä§ÌÅ¨Î¶ΩÌä∏ -->
    <script th:src="@{/js/service-insight.js(v=${#dates.createNow().getTime()})}"></script>
    <!-- Î™®Î∞îÏùº Ï†ÑÏö© Î≥¥Ï°∞ Ïä§ÌÅ¨Î¶ΩÌä∏(Ìå®ÎÑê/ÌÉÄÏù¥ÌãÄ Ïù¥Îèô) -->
    <script th:src="@{/js/service-insight.mobile.js(v=${#dates.createNow().getTime()})}"></script>
    <!-- Í≥µÌÜµ ÌÉÄÍπÉ Ï†úÏñ¥ Ïä§ÌÅ¨Î¶ΩÌä∏(PC/Î™®Î∞îÏùº) -->
    <script th:src="@{/js/service-insight.target.js(v=${#dates.createNow().getTime()})}"></script>
</th:block>
</html>
